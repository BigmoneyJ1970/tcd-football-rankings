<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>TCD Top 10</title>
<style>
  :root{
    --bg:#f5f7fa;     /* page bg from ?bg */
    --fg:#000000;     /* default text from ?fg */
    --gap:26px;       /* space between teams */
    --fs:16px;        /* computed from ?h */
    --fw:800;
    --font:var(--fw) var(--fs)/1.1 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  }

  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--fg);font:var(--font)}
  .wrap{
    display:flex;justify-content:center;align-items:center;
    gap:var(--gap);white-space:nowrap;padding:6px 8px;
  }
  .item{display:flex;align-items:baseline;gap:8px}
  .idx{opacity:.65;font-weight:700}
  .team{font-weight:800;letter-spacing:.2px}

  /* Team colors (tweak anytime) */
  .team[data-team="Texas"]{color:#bf5700}
  .team[data-team="Penn State"]{color:#041e42}
  .team[data-team="Ohio State"]{color:#bb0000}
  .team[data-team="Clemson"]{color:#f56600}
  .team[data-team="Georgia"]{color:#ba0c2f}
  .team[data-team="Notre Dame"]{color:#0c2340}
  .team[data-team="Oregon"]{color:#154733}
  .team[data-team="Alabama"]{color:#9e1b32}
  .team[data-team="Miami"]{color:#005030}

  /* Special: LSU gold fill with purple outline, slight letter spacing */
  .team[data-team="LSU"]{
    color:#f1b82d;                          /* gold fill */
    -webkit-text-stroke:1.25px #461d7c;     /* purple stroke */
    text-shadow:0 0 0 #461d7c;              /* fallback outline */
    letter-spacing:.6px;                    /* “smidge” */
  }

  /* Optional: keep rank number neutral/dark */
  .idx[data-team="LSU"]{color:#222}
</style>
</head>
<body>
  <div id="app" class="wrap" role="list" aria-live="polite"></div>

  <script>
    const Q = new URLSearchParams(location.search);

    // Params
    const POLL = (Q.get('poll') || 'ap').toLowerCase();  // ap | coaches
    const N    = Math.max(1, Math.min(25, +(Q.get('n') || 10)));
    const BG   = Q.get('bg'); if (BG) document.documentElement.style.setProperty('--bg', '#'+BG.replace(/^#/,''));
    const FG   = Q.get('fg'); if (FG) document.documentElement.style.setProperty('--fg', '#'+FG.replace(/^#/,''));
    const H    = Math.max(20, +(Q.get('h') || 32));      // pixels

    // Font size from height for a consistent fit
    const fs = Math.max(12, H - 16);
    document.documentElement.style.setProperty('--fs', fs + 'px');

    // Data sources
    // By default we use the repo-root JSON (easy). If you prefer the blob URLs
    // returned by /api/update, pass them in with ?apUrl=&coachesUrl=
    const AP_URL_FALLBACK      = '/tcd-ap.json';
    const COACHES_URL_FALLBACK = '/tcd-coaches.json';

    const AP_URL       = Q.get('apUrl')       || AP_URL_FALLBACK;
    const COACHES_URL  = Q.get('coachesUrl')  || COACHES_URL_FALLBACK;
    const SRC          = (POLL === 'coaches') ? COACHES_URL : AP_URL;

    async function main(){
      const root = document.getElementById('app');
      try{
        const r = await fetch(SRC, { cache: 'no-store' });
        if(!r.ok) throw new Error('HTTP '+r.status);
        const data = await r.json();

        const teams = (data.teams || []).slice(0, N);
        if(!teams.length) throw new Error('empty');

        root.innerHTML = teams.map(({ rk, team }) => {
          const safeTeam = (team || '').replace(/[<>&"]/g, s => ({
            '<':'&lt;','>':'&gt;','&':'&amp;','"':'&quot;'
          }[s]));
          return `
            <div class="item" role="listitem">
              <span class="idx" data-team="${safeTeam}">${rk}.</span>
              <span class="team" data-team="${safeTeam}">
                ${safeTeam === 'LSU' ? 'L&nbsp;S&nbsp;U' : safeTeam}
              </span>
            </div>`;
        }).join('');
      } catch (err) {
        console.error('top10 load error:', err);
        document.body.innerHTML =
          '<div style="padding:8px;text-align:center;font:600 14px/1 system-ui">Unable to load rankings.</div>';
      }
    }
    main();
  </script>
</body>
</html>


