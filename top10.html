
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Top 10 (Embed)</title>
  <style>
    :root{
      --bg:#f5f7fa;
      --fg:#000;
      --h:38px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    .wrap{max-width:1400px;margin:0 auto;padding:6px 10px}
    .bar{
      display:flex;gap:12px;align-items:center;justify-content:space-between;
      height:var(--h); line-height:var(--h); white-space:nowrap; overflow:hidden;
      border-radius:6px;
    }
    .slot{
      flex:1 1 0; display:flex; align-items:center; justify-content:center;
      font-weight:700; font-size:14px;
    }
    .slot .num{opacity:.8;margin-right:.4em;font-variant-numeric:tabular-nums}
    .team{display:inline-block}

    /* LSU special treatment: brighter purple + gold outline per letter + a smidge of spacing */
    .team.lsu{
      letter-spacing:.08em;
      color:#4a22a8; /* brighter purple */
      text-shadow:
        -1px -1px 0 #FDD023,  0 -1px 0 #FDD023,  1px -1px 0 #FDD023,
        -1px  0   0 #FDD023,                      1px  0   0 #FDD023,
        -1px  1px 0 #FDD023,  0  1px 0 #FDD023,  1px  1px 0 #FDD023;
    }

    /* Responsive font sizing driven by height */
    @media (min-width:480px){ .slot{font-size:calc(var(--h) * .55)} }
    @media (max-width:479.98px){ .slot{font-size:calc(var(--h) * .50)} }
  </style>
</head>
<body>
  <div class="wrap">
    <div id="bar" class="bar" aria-live="polite">
      <div class="slot"><span class="num">1.</span><span class="team">Loadingâ€¦</span></div>
    </div>
  </div>

  <script>
    /************ Config via query string ************/
    const qs = new URLSearchParams(location.search);
    const poll = (qs.get('poll') || 'ap').toLowerCase();     // 'ap' | 'coaches'
    const n    = Math.max(1, Math.min(25, +(qs.get('n') || 10)));
    const bg   = '#' + (qs.get('bg') || 'f5f7fa');
    const fg   = '#' + (qs.get('fg') || '000000');
    const hpx  = (qs.get('h') || 38) + 'px';

    document.documentElement.style.setProperty('--bg', bg);
    document.documentElement.style.setProperty('--fg', fg);
    document.documentElement.style.setProperty('--h',  hpx);

    // Use the stable Vercel Blob files your /api/update writes:
    const AP_URL       = "https://u5vu5e0xbo8k8p8i.public.blob.vercel-storage.com/tcd-ap.json";
    const COACHES_URL  = "https://u5vu5e0xbo8k8p8i.public.blob.vercel-storage.com/tcd-coaches.json";
    const SRC = poll === 'coaches' ? COACHES_URL : AP_URL;

    /************ Team color map (primary text color) ************/
    const COLORS = {
      "TEXAS": "#BF5700",
      "PENN STATE": "#041E42",
      "OHIO STATE": "#BB0000",
      "CLEMSON": "#F56600",
      "GEORGIA": "#BA0C2F",
      "NOTRE DAME": "#0C2340",
      "OREGON": "#154733",
      "ALABAMA": "#9E1B32",
      "LSU": "#4a22a8",               // brighter purple; outline added via CSS class
      "MIAMI": "#F47321",             // primary orange
      "FLORIDA STATE": "#782F40",
      "MICHIGAN": "#00274C",
      "USC": "#9D2235",
      "WASHINGTON": "#4B2E83",
      "OKLAHOMA": "#841617",
      "TEXAS A&M": "#500000",
      "TENNESSEE": "#FF8200"
      // add more as needed
    };

    function colorFor(teamName) {
      return COLORS[teamName.toUpperCase()] || getComputedStyle(document.documentElement).getPropertyValue('--fg');
    }

    /************ Render ************/
    async function main(){
      try{
        const r = await fetch(SRC, {cache:'no-store'});
        const data = await r.json();
        const teams = (data.teams || []).slice(0, n);

        const bar = document.getElementById('bar');
        bar.innerHTML = ''; // clear

        teams.forEach((t, i) => {
          const slot = document.createElement('div');
          slot.className = 'slot';

          const num = document.createElement('span');
          num.className = 'num';
          num.textContent = (t.rk || (i+1)) + '.';

          const name = document.createElement('span');
          name.className = 'team';
          name.textContent = (t.team || '').trim();

          // per-team colors
          name.style.color = colorFor(name.textContent);

          // special LSU treatment: gold outline per letter + small spacing
          if (name.textContent.toUpperCase() === 'LSU') {
            name.classList.add('lsu');
          }

          slot.appendChild(num);
          slot.appendChild(name);
          bar.appendChild(slot);
        });
      }catch(err){
        const bar = document.getElementById('bar');
        bar.innerHTML = '<div class="slot">Unable to load rankings.</div>';
        console.error(err);
      }
    }
    main();
  </script>
</body>
</html>
